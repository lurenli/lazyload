(function (global, factory) {
	typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
	typeof define === 'function' && define.amd ? define(factory) : 
	typeof define === 'function' && (define.cmd || define.hjs) ? define(function(require,exports,module){module.exports = factory()}) :
	(global.Lazyload = factory());
}(this, (function () { 'use strict';

var $Blob = function (array, option) {
    if (window.Blob) {
        return new Blob(array, option);
    }
    else {
        window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;
        if (window.BlobBuilder) {
            var bb = new BlobBuilder();
            bb.append(array);
            return bb.getBlob(typeof option === 'object' ? option.type : undefined);
        }
        
        return bb;
    }
    
};

var $addEvent = function (e, type, fn, mark) {
    if (e.addEventListener) {
        e.addEventListener(type, fn, false);
    }
    else if (e.attachEvent) {
        //e.detachEvent('on'+type,fn);
        e.attachEvent('on' + type, function () {
            fn.call(e, window.event);
        });
    }
    
};

var $URL = window.URL || window.webkitURL || window.mozURL || window.msURL;
var Lazyload = /** @class */ (function () {
    function Lazyload(obj) {
        var _ts = this;
        var config = _ts.config = {}, data = _ts.data = {}, o = _ts.obj = {
            doc: document.documentElement,
            body: document.body
        }, blankImg = 'data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==';
        for (var i in obj) {
            _ts.config[i] = obj[i];
        }
        
        //默认容差在100像
        _ts.config['range'] = typeof _ts.config['range'] === 'numver' ? _ts.config['range'] : 100;
        //图片方法扩展
        _ts.imageExtend();
        //图片数据处理
        for (var i = 0, len = config.obj.length; i < len; i++) {
            var item = config.obj[i], dataSrc = item.lazy_dataSrc = item.getAttribute('data-src'), dataCover = item.lazy_dataCover = item.getAttribute('data-cover');
            if (item.src === '') {
                item.src = blankImg;
            }
            
            item.removeAttribute('data-src');
            //将获取的对象存储起来
            if (data[dataSrc] === undefined) {
                data[dataSrc] = [];
            }
            
            data[dataSrc].push(item);
        }
        
    }
    Lazyload.prototype.init = function () {
        var _ts = this, config = _ts.config, data = _ts.data, o = _ts.obj, task, temp;
        //图片更新执行
        (task = function () {
            //得到当前屏幕区域的需要更新图片列表
            var eList = _ts.getShowList();
            //遍历加载图片
            for (var i = 0, len = eList.length; i < len; i++) {
                var item = eList[i];
                _ts.loadImg(item);
            }
            
        })();
        var run = function () {
            clearTimeout(temp);
            temp = setTimeout(task, 200);
        };
        $addEvent(window, 'scroll', run);
        $addEvent(window, 'resize', run);
    };
    /**
     * 图片方法扩展
     *
     * @memberof Lazyload
     */
    Lazyload.prototype.imageExtend = function () {
        var _ts = this;
        Image.prototype.load = function (url, oL) {
            var updateImg = function (src) {
                //更新图片
                for (var i = 0, len = oL.length; i < len; i++) {
                    var item = oL[i];
                    _ts.updateImg(item, src);
                }
                
            }, updateTips = function (o) {
                //更新提示
                for (var i = 0, len = oL.length; i < len; i++) {
                    var item = oL[i];
                    item.completedPercentage = o;
                    o.o = item;
                    _ts.tip(o);
                }
                
            };
            if ($Blob && $URL && XMLHttpRequest) {
                var img = this, xhr_1 = new XMLHttpRequest();
                xhr_1.open('GET', url, true);
                xhr_1.responseType = 'arraybuffer';
                xhr_1.onload = function (e) {
                    var headers = xhr_1.getAllResponseHeaders(), m = headers.match(/^Content-Type\:\s*(.*?)$/mi), mimeType = m[1] || 'image/png', blob = $Blob([this.response], {
                        type: mimeType
                    }), src = $URL.createObjectURL(blob);
                    updateImg(src);
                };
                xhr_1.onloadstart = xhr_1.onprogress = xhr_1.onloadend = function (e) {
                    var o = {
                        loaded: e.loaded,
                        total: e.total,
                        status: e.type,
                        schedule: e.loaded === 0 ? 0 : e.loaded / e.total
                    };
                    updateTips(o);
                };
                xhr_1.send();
            }
            else {
                var o_1 = {
                    loaded: undefined,
                    total: undefined,
                    status: 'loaded',
                    schedule: 0
                }, temp_1;
                temp_1 = setInterval(function () {
                    if (o_1.schedule > 0.98) {
                        clearInterval(temp_1);
                    }
                    
                    o_1.schedule = o_1.schedule + 0.01;
                    o_1.status = 'progress';
                    updateTips(o_1);
                }, 100);
                this.onload = function () {
                    clearInterval(temp_1);
                    updateImg(this.src);
                    o_1.status = 'loaded';
                    o_1.schedule = 1;
                    updateTips(o_1);
                };
            }
            
        };
    };
    /**
     * 获取浏览器窗口大小
     *
     * @returns {object} 容器宽高
     * @memberof Lazyload
     */
    Lazyload.prototype.getWinSize = function () {
        var _ts = this, o = _ts.obj;
        var o = {
            w: window.innerWidth || o.doc.clientWidth,
            h: window.innerHeight || o.doc.clientHeight
        };
        return o;
    };
    /**
     * 获取页面滚动的像素
     */
    Lazyload.prototype.getWinScroll = function () {
        var d = {
            // x: window.scrollX || document.compatMode == "BackCompat" ? document.body.scrollLeft : document.documentElement.scrollLeft,
            // y: window.scrollY || document.compatMode == "BackCompat" ? document.body.scrollTop : document.documentElement.scrollTop
            x: document.compatMode == "BackCompat" ? document.body.scrollLeft : document.documentElement.scrollLeft,
            y: document.compatMode == "BackCompat" ? document.body.scrollTop : document.documentElement.scrollTop
        };
        return d;
    };
    Lazyload.prototype.loadImg = function (o) {
        var _ts = this, data = _ts.data;
        //已经加载过的则不处理
        if (o.lazy_isInit) {
            return;
        }
        
        var list = data[o.lazy_dataSrc];
        // if(o.tagName === 'IMG'){
        //     o.load(o.lazy_dataSrc,list);
        // }else{
        var img = new Image();
        img.load(o.lazy_dataSrc, list);
        img.src = o.lazy_dataSrc;
        // if($Blob){
        // img.load(o.lazy_dataSrc, list);
        // }else{
        //     //模拟加载
        //     img.onload = function(){
        //         for(let i=0,len=list.length; i<len; i++){
        //             let item = list[i];
        //             _ts.updateImg(item,src);
        //         };
        //     };
        // };
        // };
        //更新图片地址相同的元素
        for (var i = 0, len = list.length; i < len; i++) {
            var item = list[i];
            if (item.lazy_isInit) {
                continue;
            }
            
            item.lazy_isInit = true;
            if (item.lazy_dataCover) {
                _ts.updateImg(item, item.lazy_dataCover);
            }
            
        }
        
    };
    /**
     * 更新图片
     *
     * @param {object} o 需要更新的元素
     * @param {string} url 图片地址
     * @memberof Lazyload
     */
    Lazyload.prototype.updateImg = function (o, url) {
        if (o.tagName === 'IMG') {
            o.src = url;
        }
        else {
            o.style.backgroundImage = "url(" + url + ")";
        }
        
    };
    Lazyload.prototype.getElementTop = function (element) {
        var actualTop = element.offsetTop, current = element.offsetParent;
        while (current !== null) {
            actualTop += current.offsetTop;
            current = current.offsetParent;
        }
        
        return actualTop;
    };
    Lazyload.prototype.getElementLeft = function (element) {
        var actualLeft = element.offsetLeft, current = element.offsetParent;
        while (current !== null) {
            actualLeft += current.offsetLeft;
            current = current.offsetParent;
        }
        
        return actualLeft;
    };
    /**
     * 获取需要显示的元素
     */
    Lazyload.prototype.getShowList = function () {
        var _ts = this, config = _ts.config;
        var scroll = _ts.getWinScroll(), winSize = _ts.getWinSize(), temp = [];
        //console.log(scroll,winSize)
        for (var i = 0, len = config.obj.length; i < len; i++) {
            var item = config.obj[i], left = _ts.getElementLeft(item), top = _ts.getElementTop(item), width = item.clientWidth, height = item.clientHeight, xl = left + width - scroll.x > 0 - config.range, //页面左侧显示条件
            xr = winSize.w + scroll.x + config.range > left, //页面右侧显示条件
            yt = top + height - scroll.y > 0 - config.range, //页面顶部显示条件
            yb = top < scroll.y + winSize.h + config.range, //页面底部显示条件
            isInit = item.lazy_isInit;
            //console.log('left',left,'top',top,'width',width,'height',height);
            if (xl && xr && yt && yb && !isInit) {
                temp.push(item);
            }
            
        }
        
        return temp;
    };
    /**
     * 默认的提示方法
     * @param obj --
     */
    Lazyload.prototype.tip = function (obj) {
        var schedule = parseInt(obj.schedule * 100) + '%', o = obj.o;
        if (o.lazy_isEchoTip === undefined) {
            o.lazy_isEchoTip = true;
            o.lazy_oTip = document.createElement('span');
            o.lazy_oTip.className = 'lazy_tip';
            o.parentNode.insertBefore(o.lazy_oTip, o.nextSibling);
            //console.log(o.lazy_otip.parentNode)
        }
        
        o.lazy_oTip.innerHTML = schedule;
        //当加载进度为1时，则移除对应的加载提示
        if (obj.schedule === 1 && o.lazy_isEchoTip) {
            o.parentNode.removeChild(o.lazy_oTip);
            o.lazy_isEchoTip = undefined;
        }
        
    };
    return Lazyload;
}());

return Lazyload;

})));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjpudWxsLCJzb3VyY2VzIjpbIi9Vc2Vycy9mYW4vd29yay93ZWIvbGF6eWxvYWQvc3JjL2pzL19CbG9iLmVzNiIsIi9Vc2Vycy9mYW4vd29yay93ZWIvbGF6eWxvYWQvc3JjL2pzL19hZGRFdmVudC5lczYiLCIvVXNlcnMvZmFuL3dvcmsvd2ViL2xhenlsb2FkL3NyYy9qcy9MYXp5bG9hZC5lczYiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgKGFycmF5LG9wdGlvbik9PntcbiAgICBpZih3aW5kb3cuQmxvYil7XG4gICAgICAgIHJldHVybiBuZXcgQmxvYihhcnJheSxvcHRpb24pXG4gICAgfWVsc2V7XG4gICAgICAgIHdpbmRvdy5CbG9iQnVpbGRlciA9IHdpbmRvdy5CbG9iQnVpbGRlciB8fCB3aW5kb3cuV2ViS2l0QmxvYkJ1aWxkZXIgfHwgd2luZG93Lk1vekJsb2JCdWlsZGVyIHx8IHdpbmRvdy5NU0Jsb2JCdWlsZGVyO1xuICAgICAgICBpZih3aW5kb3cuQmxvYkJ1aWxkZXIpe1xuICAgICAgICAgICAgbGV0IGJiID0gbmV3IEJsb2JCdWlsZGVyKCk7XG4gICAgICAgICAgICBiYi5hcHBlbmQoYXJyYXkpO1xuICAgICAgICAgICAgcmV0dXJuIGJiLmdldEJsb2IodHlwZW9mIG9wdGlvbiA9PT0gJ29iamVjdCcgPyBvcHRpb24udHlwZSA6IHVuZGVmaW5lZCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBiYjtcbiAgICB9O1xufTsiLCJleHBvcnQgZGVmYXVsdCAoZSx0eXBlLGZuLG1hcmspPT57XG4gICAgaWYoZS5hZGRFdmVudExpc3RlbmVyKXtcbiAgICAgICAgZS5hZGRFdmVudExpc3RlbmVyKHR5cGUsZm4sZmFsc2UpO1xuICAgIH1lbHNlIGlmKGUuYXR0YWNoRXZlbnQpe1xuICAgICAgICAvL2UuZGV0YWNoRXZlbnQoJ29uJyt0eXBlLGZuKTtcbiAgICAgICAgZS5hdHRhY2hFdmVudCgnb24nK3R5cGUsKCk9PntcbiAgICAgICAgICAgIGZuLmNhbGwoZSx3aW5kb3cuZXZlbnQpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTsiLCJpbXBvcnQgJEJsb2IgZnJvbSAnLi9fQmxvYi5lczYnO1xuaW1wb3J0ICRhZGRFdmVudCBmcm9tICcuL19hZGRFdmVudC5lczYnO1xuXG5jb25zdCAkVVJMID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMIHx8IHdpbmRvdy5tb3pVUkwgfHwgd2luZG93Lm1zVVJMO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMYXp5bG9hZCB7XG4gICAgY29uc3RydWN0b3Iob2JqKSB7XG4gICAgICAgIGNvbnN0IF90cyA9IHRoaXM7XG4gICAgICAgIGxldCBjb25maWcgPSBfdHMuY29uZmlnID0ge30sXG4gICAgICAgICAgICBkYXRhID0gX3RzLmRhdGEgPSB7fSxcbiAgICAgICAgICAgIG8gPSBfdHMub2JqID0ge1xuICAgICAgICAgICAgICAgIGRvYzogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LFxuICAgICAgICAgICAgICAgIGJvZHk6IGRvY3VtZW50LmJvZHlcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBibGFua0ltZyA9ICdkYXRhOmltYWdlL2dpZjtiYXNlNjQsaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUFFQUFBQUJDQVlBQUFBZkZjU0pBQUFBRFVsRVFWUUltV05nWUdCZ0FBQUFCUUFCaDZGTzFBQUFBQUJKUlU1RXJrSmdnZz09JztcblxuICAgICAgICBmb3IgKGxldCBpIGluIG9iaikge1xuICAgICAgICAgICAgX3RzLmNvbmZpZ1tpXSA9IG9ialtpXTtcbiAgICAgICAgfTtcblxuICAgICAgICAvL+m7mOiupOWuueW3ruWcqDEwMOWDj1xuICAgICAgICBfdHMuY29uZmlnWydyYW5nZSddID0gdHlwZW9mIF90cy5jb25maWdbJ3JhbmdlJ10gPT09ICdudW12ZXInID8gX3RzLmNvbmZpZ1sncmFuZ2UnXSA6IDEwMDtcblxuICAgICAgICAvL+WbvueJh+aWueazleaJqeWxlVxuICAgICAgICBfdHMuaW1hZ2VFeHRlbmQoKTtcblxuICAgICAgICAvL+WbvueJh+aVsOaNruWkhOeQhlxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gY29uZmlnLm9iai5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgbGV0IGl0ZW0gPSBjb25maWcub2JqW2ldLFxuICAgICAgICAgICAgICAgIGRhdGFTcmMgPSBpdGVtLmxhenlfZGF0YVNyYyA9IGl0ZW0uZ2V0QXR0cmlidXRlKCdkYXRhLXNyYycpLFxuICAgICAgICAgICAgICAgIGRhdGFDb3ZlciA9IGl0ZW0ubGF6eV9kYXRhQ292ZXIgPSBpdGVtLmdldEF0dHJpYnV0ZSgnZGF0YS1jb3ZlcicpO1xuXG4gICAgICAgICAgICBpZiAoaXRlbS5zcmMgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgaXRlbS5zcmMgPSBibGFua0ltZztcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpdGVtLnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1zcmMnKTtcblxuICAgICAgICAgICAgLy/lsIbojrflj5bnmoTlr7nosaHlrZjlgqjotbfmnaVcbiAgICAgICAgICAgIGlmIChkYXRhW2RhdGFTcmNdID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBkYXRhW2RhdGFTcmNdID0gW107XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZGF0YVtkYXRhU3JjXS5wdXNoKGl0ZW0pO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGluaXQoKSB7XG4gICAgICAgIGNvbnN0IF90cyA9IHRoaXMsXG4gICAgICAgICAgICBjb25maWcgPSBfdHMuY29uZmlnLFxuICAgICAgICAgICAgZGF0YSA9IF90cy5kYXRhLFxuICAgICAgICAgICAgbyA9IF90cy5vYmosXG4gICAgICAgICAgICB0YXNrLFxuICAgICAgICAgICAgdGVtcDtcblxuICAgICAgICAvL+WbvueJh+abtOaWsOaJp+ihjFxuICAgICAgICAodGFzayA9ICgpID0+IHtcbiAgICAgICAgICAgIC8v5b6X5Yiw5b2T5YmN5bGP5bmV5Yy65Z+f55qE6ZyA6KaB5pu05paw5Zu+54mH5YiX6KGoXG4gICAgICAgICAgICBsZXQgZUxpc3QgPSBfdHMuZ2V0U2hvd0xpc3QoKTtcblxuICAgICAgICAgICAgLy/pgY3ljobliqDovb3lm77niYdcbiAgICAgICAgICAgIGZvcihsZXQgaT0wLGxlbj1lTGlzdC5sZW5ndGg7IGk8bGVuOyBpKyspe1xuICAgICAgICAgICAgICAgIGxldCBpdGVtID0gZUxpc3RbaV0sXG4gICAgICAgICAgICAgICAgICAgIGtleSA9IGl0ZW0ubGF6eV9kYXRhU3JjO1xuICAgICAgICAgICAgICAgIF90cy5sb2FkSW1nKGl0ZW0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkoKTtcblxuICAgICAgICBsZXQgcnVuID0gKCk9PntcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0ZW1wKTtcbiAgICAgICAgICAgIHRlbXAgPSBzZXRUaW1lb3V0KHRhc2ssIDIwMCk7XG4gICAgICAgIH07XG5cbiAgICAgICAgJGFkZEV2ZW50KHdpbmRvdywnc2Nyb2xsJyxydW4pO1xuICAgICAgICAkYWRkRXZlbnQod2luZG93LCdyZXNpemUnLHJ1bik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog5Zu+54mH5pa55rOV5omp5bGVXG4gICAgICogXG4gICAgICogQG1lbWJlcm9mIExhenlsb2FkXG4gICAgICovXG4gICAgaW1hZ2VFeHRlbmQoKSB7XG4gICAgICAgIGNvbnN0IF90cyA9IHRoaXM7XG5cbiAgICAgICAgSW1hZ2UucHJvdG90eXBlLmxvYWQgPSBmdW5jdGlvbiAodXJsLCBvTCkge1xuICAgICAgICAgICAgbGV0IHVwZGF0ZUltZyA9IChzcmMpID0+IHtcbiAgICAgICAgICAgICAgICAvL+abtOaWsOWbvueJh1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBvTC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IG9MW2ldO1xuICAgICAgICAgICAgICAgICAgICBfdHMudXBkYXRlSW1nKGl0ZW0sIHNyYyk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB1cGRhdGVUaXBzID0gKG8pID0+IHtcbiAgICAgICAgICAgICAgICAvL+abtOaWsOaPkOekulxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBvTC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBsZXQgaXRlbSA9IG9MW2ldO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNvbXBsZXRlZFBlcmNlbnRhZ2UgPSBvO1xuICAgICAgICAgICAgICAgICAgICBvLm8gPSBpdGVtO1xuICAgICAgICAgICAgICAgICAgICBfdHMudGlwKG8pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoJEJsb2IgJiYgJFVSTCAmJiBYTUxIdHRwUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgIGxldCBpbWcgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgICB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgICAgICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCB1cmwsIHRydWUpO1xuICAgICAgICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgICAgICAgICAgICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgaGVhZGVycyA9IHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG0gPSBoZWFkZXJzLm1hdGNoKC9eQ29udGVudC1UeXBlXFw6XFxzKiguKj8pJC9taSksXG4gICAgICAgICAgICAgICAgICAgICAgICBtaW1lVHlwZSA9IG1bMV0gfHwgJ2ltYWdlL3BuZycsXG4gICAgICAgICAgICAgICAgICAgICAgICBibG9iID0gJEJsb2IoW3RoaXMucmVzcG9uc2VdLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogbWltZVR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3JjID0gJFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZUltZyhzcmMpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB4aHIub25sb2Fkc3RhcnQgPSB4aHIub25wcm9ncmVzcyA9IHhoci5vbmxvYWRlbmQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRlZDogZS5sb2FkZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RhbDogZS50b3RhbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogZS50eXBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGU6IGUubG9hZGVkID09PSAwID8gMCA6IGUubG9hZGVkIC8gZS50b3RhbFxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVUaXBzKG8pO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgeGhyLnNlbmQoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGV0IG8gPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6ICdsb2FkZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NoZWR1bGU6IDBcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGVtcDtcblxuICAgICAgICAgICAgICAgIHRlbXAgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvLnNjaGVkdWxlID4gMC45OCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0ZW1wKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgby5zY2hlZHVsZSA9IG8uc2NoZWR1bGUgKyAwLjAxO1xuICAgICAgICAgICAgICAgICAgICBvLnN0YXR1cyA9ICdwcm9ncmVzcyc7XG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZVRpcHMobyk7XG4gICAgICAgICAgICAgICAgfSwgMTAwKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0ZW1wKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlSW1nKHRoaXMuc3JjKTtcbiAgICAgICAgICAgICAgICAgICAgby5zdGF0dXMgPSAnbG9hZGVkJztcbiAgICAgICAgICAgICAgICAgICAgby5zY2hlZHVsZSA9IDE7XG5cbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlVGlwcyhvKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDojrflj5bmtY/op4jlmajnqpflj6PlpKflsI9cbiAgICAgKiBcbiAgICAgKiBAcmV0dXJucyB7b2JqZWN0fSDlrrnlmajlrr3pq5hcbiAgICAgKiBAbWVtYmVyb2YgTGF6eWxvYWRcbiAgICAgKi9cbiAgICBnZXRXaW5TaXplKCkge1xuICAgICAgICBjb25zdCBfdHMgPSB0aGlzLFxuICAgICAgICAgICAgbyA9IF90cy5vYmo7XG4gICAgICAgIGxldCBvID0ge1xuICAgICAgICAgICAgdzogd2luZG93LmlubmVyV2lkdGggfHwgby5kb2MuY2xpZW50V2lkdGgsXG4gICAgICAgICAgICBoOiB3aW5kb3cuaW5uZXJIZWlnaHQgfHwgby5kb2MuY2xpZW50SGVpZ2h0XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBvO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIOiOt+WPlumhtemdoua7muWKqOeahOWDj+e0oFxuICAgICAqL1xuICAgIGdldFdpblNjcm9sbCgpIHtcbiAgICAgICAgY29uc3QgX3RzID0gdGhpcyxcbiAgICAgICAgICAgIG8gPSBfdHMub2JqO1xuICAgICAgICBsZXQgZCA9IHtcbiAgICAgICAgICAgIC8vIHg6IHdpbmRvdy5zY3JvbGxYIHx8IGRvY3VtZW50LmNvbXBhdE1vZGUgPT0gXCJCYWNrQ29tcGF0XCIgPyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCxcbiAgICAgICAgICAgIC8vIHk6IHdpbmRvdy5zY3JvbGxZIHx8IGRvY3VtZW50LmNvbXBhdE1vZGUgPT0gXCJCYWNrQ29tcGF0XCIgPyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3BcbiAgICAgICAgICAgIHg6IGRvY3VtZW50LmNvbXBhdE1vZGUgPT0gXCJCYWNrQ29tcGF0XCIgPyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCxcbiAgICAgICAgICAgIHk6IGRvY3VtZW50LmNvbXBhdE1vZGUgPT0gXCJCYWNrQ29tcGF0XCIgPyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3BcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZDtcbiAgICB9XG5cbiAgICBsb2FkSW1nKG8pIHtcbiAgICAgICAgY29uc3QgX3RzID0gdGhpcyxcbiAgICAgICAgICAgIGRhdGEgPSBfdHMuZGF0YTtcblxuICAgICAgICAvL+W3sue7j+WKoOi9vei/h+eahOWImeS4jeWkhOeQhlxuICAgICAgICBpZiAoby5sYXp5X2lzSW5pdCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgbGV0IGxpc3QgPSBkYXRhW28ubGF6eV9kYXRhU3JjXTtcblxuICAgICAgICAvLyBpZihvLnRhZ05hbWUgPT09ICdJTUcnKXtcbiAgICAgICAgLy8gICAgIG8ubG9hZChvLmxhenlfZGF0YVNyYyxsaXN0KTtcbiAgICAgICAgLy8gfWVsc2V7XG4gICAgICAgIGxldCBpbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgaW1nLmxvYWQoby5sYXp5X2RhdGFTcmMsIGxpc3QpO1xuICAgICAgICBpbWcuc3JjID0gby5sYXp5X2RhdGFTcmM7XG5cbiAgICAgICAgLy8gaWYoJEJsb2Ipe1xuICAgICAgICAvLyBpbWcubG9hZChvLmxhenlfZGF0YVNyYywgbGlzdCk7XG4gICAgICAgIC8vIH1lbHNle1xuICAgICAgICAvLyAgICAgLy/mqKHmi5/liqDovb1cbiAgICAgICAgLy8gICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyAgICAgICAgIGZvcihsZXQgaT0wLGxlbj1saXN0Lmxlbmd0aDsgaTxsZW47IGkrKyl7XG4gICAgICAgIC8vICAgICAgICAgICAgIGxldCBpdGVtID0gbGlzdFtpXTtcbiAgICAgICAgLy8gICAgICAgICAgICAgX3RzLnVwZGF0ZUltZyhpdGVtLHNyYyk7XG4gICAgICAgIC8vICAgICAgICAgfTtcbiAgICAgICAgLy8gICAgIH07XG4gICAgICAgIC8vIH07XG5cbiAgICAgICAgLy8gfTtcblxuXG4gICAgICAgIC8v5pu05paw5Zu+54mH5Zyw5Z2A55u45ZCM55qE5YWD57SgXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBsaXN0Lmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgaXRlbSA9IGxpc3RbaV07XG4gICAgICAgICAgICBpZiAoaXRlbS5sYXp5X2lzSW5pdCkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGl0ZW0ubGF6eV9pc0luaXQgPSB0cnVlO1xuICAgICAgICAgICAgaWYoaXRlbS5sYXp5X2RhdGFDb3Zlcil7XG4gICAgICAgICAgICAgICAgX3RzLnVwZGF0ZUltZyhpdGVtLCBpdGVtLmxhenlfZGF0YUNvdmVyKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICog5pu05paw5Zu+54mHXG4gICAgICogXG4gICAgICogQHBhcmFtIHtvYmplY3R9IG8g6ZyA6KaB5pu05paw55qE5YWD57SgXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHVybCDlm77niYflnLDlnYBcbiAgICAgKiBAbWVtYmVyb2YgTGF6eWxvYWRcbiAgICAgKi9cbiAgICB1cGRhdGVJbWcobywgdXJsKSB7XG4gICAgICAgIGlmIChvLnRhZ05hbWUgPT09ICdJTUcnKSB7XG4gICAgICAgICAgICBvLnNyYyA9IHVybDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG8uc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke3VybH0pYDtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBnZXRFbGVtZW50VG9wKGVsZW1lbnQpIHtcbiAgICAgICAgbGV0IGFjdHVhbFRvcCA9IGVsZW1lbnQub2Zmc2V0VG9wLFxuICAgICAgICAgICAgY3VycmVudCA9IGVsZW1lbnQub2Zmc2V0UGFyZW50O1xuXG4gICAgICAgIHdoaWxlIChjdXJyZW50ICE9PSBudWxsKSB744CA44CA44CA44CA44CA44CAXG4gICAgICAgICAgICBhY3R1YWxUb3AgKz0gY3VycmVudC5vZmZzZXRUb3A744CA44CA44CA44CA44CA44CAXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5vZmZzZXRQYXJlbnQ744CA44CA44CA44CAXG4gICAgICAgIH0744CA44CA44CAXG4gICAgICAgIHJldHVybiBhY3R1YWxUb3A7XG4gICAgfVxuXG4gICAgZ2V0RWxlbWVudExlZnQoZWxlbWVudCkge1xuICAgICAgICBsZXQgYWN0dWFsTGVmdCA9IGVsZW1lbnQub2Zmc2V0TGVmdCxcbiAgICAgICAgICAgIGN1cnJlbnQgPSBlbGVtZW50Lm9mZnNldFBhcmVudDtcbuOAgOOAgOOAgFxuICAgICAgICB3aGlsZSAoY3VycmVudCAhPT0gbnVsbCkge+OAgOOAgOOAgOOAgOOAgOOAgFxuICAgICAgICAgICAgYWN0dWFsTGVmdCArPSBjdXJyZW50Lm9mZnNldExlZnQ744CA44CA44CA44CA44CA44CAXG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudC5vZmZzZXRQYXJlbnQ744CA44CA44CA44CAXG4gICAgICAgIH07XG4gICAgICAgIOOAgOOAgOOAgOOAgFxuICAgICAgICByZXR1cm4gYWN0dWFsTGVmdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiDojrflj5bpnIDopoHmmL7npLrnmoTlhYPntKBcbiAgICAgKi9cbiAgICBnZXRTaG93TGlzdCgpIHtcbiAgICAgICAgY29uc3QgX3RzID0gdGhpcyxcbiAgICAgICAgICAgIGNvbmZpZyA9IF90cy5jb25maWcsXG4gICAgICAgICAgICBkYXRhID0gX3RzLmRhdGE7XG5cbiAgICAgICAgbGV0IHNjcm9sbCA9IF90cy5nZXRXaW5TY3JvbGwoKSxcbiAgICAgICAgICAgIHdpblNpemUgPSBfdHMuZ2V0V2luU2l6ZSgpLFxuICAgICAgICAgICAgdGVtcCA9IFtdO1xuICAgICAgICAvL2NvbnNvbGUubG9nKHNjcm9sbCx3aW5TaXplKVxuXG4gICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBjb25maWcub2JqLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgaXRlbSA9IGNvbmZpZy5vYmpbaV0sXG4gICAgICAgICAgICAgICAgbGVmdCA9IF90cy5nZXRFbGVtZW50TGVmdChpdGVtKSxcbiAgICAgICAgICAgICAgICB0b3AgPSBfdHMuZ2V0RWxlbWVudFRvcChpdGVtKSxcbiAgICAgICAgICAgICAgICB3aWR0aCA9IGl0ZW0uY2xpZW50V2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gaXRlbS5jbGllbnRIZWlnaHQsXG4gICAgICAgICAgICAgICAgeGwgPSBsZWZ0ICsgd2lkdGggLSBzY3JvbGwueCA+IDAgLSBjb25maWcucmFuZ2UsIC8v6aG16Z2i5bem5L6n5pi+56S65p2h5Lu2XG4gICAgICAgICAgICAgICAgeHIgPSB3aW5TaXplLncgKyBzY3JvbGwueCArIGNvbmZpZy5yYW5nZSA+IGxlZnQsIC8v6aG16Z2i5Y+z5L6n5pi+56S65p2h5Lu2XG4gICAgICAgICAgICAgICAgeXQgPSB0b3AgKyBoZWlnaHQgLSBzY3JvbGwueSA+IDAgLSBjb25maWcucmFuZ2UsIC8v6aG16Z2i6aG26YOo5pi+56S65p2h5Lu2XG4gICAgICAgICAgICAgICAgeWIgPSB0b3AgPCBzY3JvbGwueSArIHdpblNpemUuaCArIGNvbmZpZy5yYW5nZSwgLy/pobXpnaLlupXpg6jmmL7npLrmnaHku7ZcbiAgICAgICAgICAgICAgICBpc0luaXQgPSBpdGVtLmxhenlfaXNJbml0O1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnbGVmdCcsbGVmdCwndG9wJyx0b3AsJ3dpZHRoJyx3aWR0aCwnaGVpZ2h0JyxoZWlnaHQpO1xuXG4gICAgICAgICAgICBpZiAoeGwgJiYgeHIgJiYgeXQgJiYgeWIgJiYgIWlzSW5pdCkge1xuICAgICAgICAgICAgICAgIHRlbXAucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiB0ZW1wO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIOm7mOiupOeahOaPkOekuuaWueazlVxuICAgICAqIEBwYXJhbSBvYmogLS1cbiAgICAgKi9cbiAgICB0aXAob2JqKSB7XG4gICAgICAgIGxldCBzY2hlZHVsZSA9IHBhcnNlSW50KG9iai5zY2hlZHVsZSAqIDEwMCkgKyAnJScsXG4gICAgICAgICAgICBvID0gb2JqLm87XG5cbiAgICAgICAgaWYgKG8ubGF6eV9pc0VjaG9UaXAgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgby5sYXp5X2lzRWNob1RpcCA9IHRydWU7XG4gICAgICAgICAgICBvLmxhenlfb1RpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICAgIG8ubGF6eV9vVGlwLmNsYXNzTmFtZSA9ICdsYXp5X3RpcCc7XG4gICAgICAgICAgICBvLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG8ubGF6eV9vVGlwLCBvLm5leHRTaWJsaW5nKTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coby5sYXp5X290aXAucGFyZW50Tm9kZSlcbiAgICAgICAgfTtcblxuICAgICAgICBvLmxhenlfb1RpcC5pbm5lckhUTUwgPSBzY2hlZHVsZTtcblxuICAgICAgICAvL+W9k+WKoOi9vei/m+W6puS4ujHml7bvvIzliJnnp7vpmaTlr7nlupTnmoTliqDovb3mj5DnpLpcbiAgICAgICAgaWYob2JqLnNjaGVkdWxlID09PSAxICYmIG8ubGF6eV9pc0VjaG9UaXApe1xuICAgICAgICAgICAgby5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG8ubGF6eV9vVGlwKTtcbiAgICAgICAgICAgIG8ubGF6eV9pc0VjaG9UaXAgPSB1bmRlZmluZWQ7XG4gICAgICAgIH07XG4gICAgfVxufTsiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsWUFBZSxVQUFDLEtBQUssRUFBQyxNQUFNO0lBQ3hCLElBQUcsTUFBTSxDQUFDLElBQUksRUFBQztRQUNYLE9BQU8sSUFBSSxJQUFJLENBQUMsS0FBSyxFQUFDLE1BQU0sQ0FBQyxDQUFBO0tBQ2hDO1NBQUk7UUFDRCxNQUFNLENBQUMsV0FBVyxHQUFHLE1BQU0sQ0FBQyxXQUFXLElBQUksTUFBTSxD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